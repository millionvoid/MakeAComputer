`default_nettype none

module thinpad_top(
    input wire clk_50M,           //50MHz ???????
     input wire clk_11M0592,       //11.0592MHz ????

     input wire clock_btn,         //BTN5???????????????????????????1
     input wire reset_btn,         //BTN6????????????????????????????1

     input  wire[3:0]  touch_btn,  //BTN1~BTN4???????????????1
     input  wire[31:0] dip_sw,     //32???????????????ON????1
     output wire[15:0] leds,       //16??ED??????1???
     output wire[7:0]  dpy0,       //??????????????????????1???
     output wire[7:0]  dpy1,       //??????????????????????1???

     //CPLD?????????
     output wire uart_rdn,         //????????????
     output wire uart_wrn,         //???????????
     input wire uart_dataready,    //???????????
     input wire uart_tbre,         //????????
     input wire uart_tsre,         //??????????

     //BaseRAM???
     inout wire[31:0] base_ram_data,  //BaseRAM????????CPLD??????????
     output wire[19:0] base_ram_addr, //BaseRAM???
     output wire[3:0] base_ram_be_n,  //BaseRAM????????????????????????????????0
     output wire base_ram_ce_n,       //BaseRAM????????
     output wire base_ram_oe_n,       //BaseRAM?????????
     output wire base_ram_we_n,       //BaseRAM????????

     //ExtRAM???
     inout wire[31:0] ext_ram_data,  //ExtRAM???
     output wire[19:0] ext_ram_addr, //ExtRAM???
     output wire[3:0] ext_ram_be_n,  //ExtRAM????????????????????????????????0
     output wire ext_ram_ce_n,       //ExtRAM????????
     output wire ext_ram_oe_n,       //ExtRAM?????????
     output wire ext_ram_we_n,       //ExtRAM????????

     //?????????
     output wire txd,  //????????????
     input  wire rxd,  //?????????

     //Flash??????????? JS28F640 ?????
     output wire [22:0]flash_a,      //Flash?????a0???8bit??????16bit?????
     inout  wire [15:0]flash_d,      //Flash???
     output wire flash_rp_n,         //Flash???????????
     output wire flash_vpen,         //Flash?????????????????????????
     output wire flash_ce_n,         //Flash??????????
     output wire flash_oe_n,         //Flash???????????
     output wire flash_we_n,         //Flash??????????
     output wire flash_byte_n,       //Flash 8bit???????????????flash?16???????1

     //USB ??????????? SL811 ?????
     output wire sl811_a0,
     //inout  wire[7:0] sl811_d,     //USB?????????????m9k_sd[7:0]???
     output wire sl811_wr_n,
     output wire sl811_rd_n,
     output wire sl811_cs_n,
     output wire sl811_rst_n,
     output wire sl811_dack_n,
     input  wire sl811_intrq,
     input  wire sl811_drq_n,

     //????????????? DM9000A ?????
     output wire dm9k_cmd,
     inout  wire[15:0] dm9k_sd,
     output wire dm9k_iow_n,
     output wire dm9k_ior_n,
     output wire dm9k_cs_n,
     output wire dm9k_pwrst_n,
     input  wire dm9k_int,

    //????????
    output wire[2:0] video_red,    //??????3?
    output wire[2:0] video_green,  //?????3?
    output wire[1:0] video_blue,   //??????2?
    output wire video_hsync,       //???????????????
    output wire video_vsync,       //?????????????????
    output wire video_clk,         //???????
    output wire video_de           //??????????????????
);

 wire CPUclk;
 wire[31:0] InstAddress;
 wire[31:0] InstInput;
 wire[31:0] MemAddress;
 wire[31:0] MemReadData;
 wire[31:0] MemWriteData;
 wire MemReadEN;
 wire MemWriteEN;
 wire [1:0]MemReadSelect;
 wire MemWriteSelect;

 CPU CPU_c(
     .clk(CPUclk),
     .rst(reset_btn),
     .InstAddress(InstAddress),
     .InstInput(InstInput),
     .MemAddress(MemAddress),
     .MemReadData(MemReadData),
     .MemWriteData(MemWriteData),
     .MemReadEN(MemReadEN),
     .MemWriteEN(MemWriteEN),
     .MemReadSelect(MemReadSelect),
     .MemWriteSelect(MemWriteSelect)
 );

 Memory memory_c(
     .uart_rdn(uart_rdn),
     .uart_wrn(uart_wrn),
     .uart_dataready(uart_dataready),
     .uart_tbre(uart_tbre),
     .uart_tsre(uart_tsre),

     .ram_data(base_ram_data),
     .ram_addr(base_ram_addr),
     .ram_CE(base_ram_ce_n),
     .ram_OE(base_ram_oe_n),
     .ram_WE(base_ram_we_n),
     .ram_BE(base_ram_be_n),
    
     .ext_ram_data(ext_ram_data),
     .ext_ram_addr(ext_ram_addr),
     .ext_ram_CE(ext_ram_ce_n),
     .ext_ram_OE(ext_ram_oe_n),
     .ext_ram_WE(ext_ram_we_n),
     .ext_ram_BE(ext_ram_be_n),
    
     .clk(clk_50M),
     .rst(reset_btn),
     .CPUclk(CPUclk),
    
     .InstAddress(InstAddress),
     .InstInput(InstInput),
    
     .MemReadEN(MemReadEN),
     .MemWriteEN(MemWriteEN),
     .MemReadSelect(MemReadSelect),
     .MemWriteSelect(MemWriteSelect),
     .MemAddress(MemAddress),
     .MemWriteData(MemWriteData),
     .MemReadData(MemReadData)
 );

wire [11:0] hdata;
wire [11:0] vdata;

assign video_clk = clk_50M;
vga #(12, 800, 856, 976, 1040, 600, 637, 643, 666, 1, 1) vga800x600at75 (
    .clk(clk_50M), 
    .hdata(hdata), //????
    .vdata(vdata),      //???
    .hsync(video_hsync),
    .vsync(video_vsync),
    .data_enable(video_de),
    .r(video_red),
    .g(video_green),
    .b(video_blue)
);

endmodule
